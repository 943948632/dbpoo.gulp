$(function(){
    // 返回顶部
    var backtop = new backTop({
        scrollName: "scrollUp",
        scrollDistance: 200,
        scrollTarget: 0,
        zIndex: 1080
    });

    // qr
    var qrTimer,sqrTimer;
    $('.qr-hover,.qr-wx').on('mouseover', function(){
        clearTimeout(qrTimer);
        qrshow();
    });

    $('.qr-hover,.qr-wx').on('mouseout', function(){
        qrhide();
    });

    function qrhide() {
        qrTimer = setTimeout(function(){
            $('.qr-wx').hide();
        },200)
    }

    function qrshow() {
        $('.qr-wx').show();
    }

    // youku video
    if($(".detail-con iframe").length > 0) {
        $(".detail-con iframe").each(function(){
            var iframesrc = $(this).attr("src");
            var isplayer = iframesrc.match(/youku|embed/);
            if(isplayer && Device.os.phone) {
                $(this).css({
                    "width" : "100%",
                    "height" : "260px"
                });
            } else {
                $(this).css({
                    "width" : "100%",
                    "height" : "400px"
                });
            }
        })
    }

    // sider wx
    $('.thlink-weixin,.thlink-popwx').on('mouseover', function(){
        clearTimeout(sqrTimer);
        sqrshow();
    });

    $('.thlink-weixin,.thlink-popwx').on('mouseout', function(){
        sqrhide();
    });

    function sqrhide() {
        sqrTimer = setTimeout(function(){
            $('.thlink-popwx').hide();
        },200)
    }

    function sqrshow() {
        $('.thlink-popwx').show();
    }

    // 导航
    var curChannel = $('#channel').text();

    if(curChannel == 'index'){
        $('.tmenuli-1').addClass('on');
    }

    if(curChannel == 'general' || curChannel == 'announce' || curChannel == 'news' || curChannel == 'media' ){
        $('.tmenuli-2').addClass('on');
    }

    if(curChannel == 'video' || curChannel == 'wallpaper' || curChannel == 'screenshot' ){
        $('.tmenuli-5').addClass('on');
    }

    if(curChannel != ''){
        $('.pnav a.pnav-'+curChannel).addClass('on');
    }

    // 预约
    var phonenameValue;
    var phonetypeValue;
    var phonenumValue;

    $('.yy-select dd').on('click', function(){
        $('.yy-select dd').removeClass('select');
        $(this).addClass('select');
        phonenameValue = $('.select img').data('name');
        phonetypeValue = $('.select img').data('select');
    });

    $('.yy-inpbtn').on('click', function(){
        phonenumValue = $('#yy-phonenum').val();
        new Reserve({
            tablename : "anhei2_makeappointment_info",
            phonename : phonenameValue,
            phonetype : phonetypeValue,
            phonenum  : phonenumValue
        })
    });

    $(document).on('mouseup', function(e){
        if($(e.target).is('.modal')){
            modalHide();
        }
    });

    function show(curID){
        $('body').addClass('modal-open');
        $('#mask').show();
        $('#' + curID).show();
    }

    function hide(curID){
        $('.modal,.modal-backdrop').hide();
        $('body').removeClass('modal-open');
        $('#mask').hide();
        $('#' + curID).hide();
    }

    function modalHide(){
        $('.modal,.modal-backdrop').hide();
        $('body').removeClass('modal-open');
        $('#mask').hide();
    }

    // youku video
    if($(".detail-con iframe").length > 0) {
        $(".detail-con iframe").each(function(){
            var iframesrc = $(this).attr("src");
            var isplayer = iframesrc.match(/youku|embed/);
            if(isplayer) {
                $(this).css({
                    "width" : "100%",
                    "height" : "400px"
                });
            }
        })
    }

    $('.yy-btn').on('click', function(){
        show('yuyue-modal');
    });

    $('.modal-close,.modal-backdrop').on('click', function(){
        modalHide();
    });

});